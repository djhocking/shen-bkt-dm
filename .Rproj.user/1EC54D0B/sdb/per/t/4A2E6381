{
    "contents" : "model{\n  \n  #### Survival\n  for(t in 1:(nYears-1)){\n    for(i in 1:nSites){  \n      for(a in 1:nAges){\n        omega[i,t,a] <- 1/(1 + exp(-lomega.lim[i,t,a]))\n        lomega.lim[i,t,a] <- min(999, max(-999, lomega[i,t,a]))\n        lomega[i,t,a] <- omega.mu[a] + omega.b[1,a]*fall.flow[t] + omega.b[2,a]*winter.flow[t] + \n                         omega.b[3,a]*spring.flow[t] + omega.b[4,a]*spring.temp[t] + omega.b[5,a]*elev[i]   \n      }\n    }\n  }\n\n  #### Survival Priors\n  for(a in 1:nAges){\n    omega.mean[a] ~ dunif(0.1,0.9)\n    omega.mu[a] <- log(omega.mean[a]/(1-omega.mean[a]))\n    for(j in 1:5){\n      omega.b[j,a] ~ dnorm(0,0.37)  # Jefferey's priors: vague on logit scale\n    }\n  }\n    \n  \n  #### Per capita recruitment\n  for(t in 1:(nYears-1)){\n    for(i in 1:nSites){\n      # Ricker stock-recruitment & environmental covariates (p. 174 Guy & Brown)\n      log(gamma[i,t]) <- alpha - beta*N[i,t,2] +   # Ricker curve\n                         gamma.b[1]*fall.flow[t] + gamma.b[2]*winter.flow[t] +  # env covariates \n                         gamma.b[3]*spring.flow[t] + gamma.b[4]*spring.temp[t] + gamma.b[5]*elev[i] \n    }\n  }\n       \n  #### Recruitment Priors\n  for(j in 1:5){\n    gamma.b[j] ~ dnorm(0, 0.01)  \n  }\n \n  #### Ricker stock-recruitment priors\n  alpha ~ dunif(0,5)\n  beta ~ dnorm(0, 0.1)#T(0,)\n  \n  #### Initial abundance priors\n  for(a in 1:nAges){\n    lambda[a] ~ dunif(0,500)\n  }\n  \n    \n  ##### N section\n  for(i in 1:nSites){\n    for(a in 1:nAges){\n      # Year 1 - initial abundance\n        N[i,1,a] ~ dpois(lambda[a])             \n    }\n  }\n  \n  # Year 2+ \n  for(i in 1:nSites){\n    for(t in 2:nYears) {\n        #Estimate recruitment\n        N[i,t,1] ~ dpois(gamma[i,t-1]*N[i,t-1,2])\n          \n        #Estimate survival\n        S[i,t-1,1] ~ dbin(omega[i,t-1,1], N[i,t-1,1])\n        S[i,t-1,2] ~ dbin(omega[i,t-1,2], N[i,t-1,2])\n        N[i,t,2] <- S[i,t-1,1] + S[i,t-1,2]\n    }\n  }\n\n  \n  #### Detection\n  for(i in 1:nSites) {\n    for(t in 1:nYears){\n      for(a in 1:nAges){\n        y[i,t,a,1] ~ dbin(p[i,t,a], N[i,t,a])\n        y[i,t,a,2] ~ dbin(p[i,t,a], (N[i,t,a]-y[i,t,a,1]))\n        y[i,t,a,3] ~ dbin(p[i,t,a], (N[i,t,a]-y[i,t,a,1]-y[i,t,a,2]))  \n        \n        p[i,t,a] <- 1/(1 + exp(-lp.lim[i,t,a]))\n        lp.lim[i,t,a] <- min(999, max(-999, lp[i,t,a]))\n        lp[i,t,a] <- p.mu[a] + p.b[1]*Jdate[i,t] + p.b[2]*width[i,t]\n      }\n    }  \n  }\n  \n  #### Detection priors\n  for(a in 1:nAges){\n    p.mean[a] ~ dunif(0.1,0.9)    # need to bound: otherwise stuck at values very close to 0\n    p.mu[a] <- log(p.mean[a]/(1-p.mean[a]))\n  }\n\n  p.b[1] ~ dnorm(0,0.01)\n  p.b[2] ~ dnorm(0,0.01)\n  \n  \n  ## sum up the number of individuals in all sites to estimate annual total N\n  for (t in 1:nYears){\n    for(a in 1:2){ \n      Ntotal[t,a] <- sum(N[,t,a])\n    } \n  }\n\n}",
    "created" : 1389892666524.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1973857976",
    "id" : "4A2E6381",
    "lastKnownWriteTime" : 1389890371,
    "path" : "~/Documents/Research/Stream_Climate_Change/Kanno_Brook_Trout/Shen Dail Madsen model ver 6.8.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}